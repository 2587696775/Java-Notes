# 日志文件没有输出Mybatis日志

**问题描述：**

项目启动后，在控制台会打印Mybatis日志，但是在logback中配置的输出日志文件中没有Mybatis的日志。

**问题原因**

在spring boot的配置文件中，配置的mybatis.configuration.log-impl是org.apache.ibatis.logging.stdout.StdOutImpl，它的日志都是**System.out.println(s);**的控制台输出。

**将StdOutImpl改成Slf4jImpl**

# 投产忘记更新包，导致“代码没生效”

毕业第一个项目，是一个多模块的项目，每个模块一个应用，大概有6个模块，两台服务器，就相当于要传12个包，有一次投产更新版本，项目经理上完包启动，发现最新的代码感觉没生效一样，他们就一直查日志，看是不是自己的代码没提交，后来我发现是有一个模块的包的日期还是之前的。

# 前端验证码存在session，多台服务器不共享问题

**问题描述：**

原来项目是一台服务器，前端请求验证码，验证码存在session，验证的时候从session中取然后验证。

后来项目扩展为两台应用集群，出现了请求验证码是在这台，验证的请求到了另一台，这时候验证就出了问题

**解决**

请求验证码的时候把验证码存到redis并设置过期时间，返回给前端一个验证码id，验证的时候根据id去redis取。

# 投资产品抢购问题

## 高并发

用户多的时候，客户端响应很慢。

1.  **缓存**：把投资产品的数据放到Redis，客户端查询更快。
2.  **限流**：Nginx对IP进行限流，限制单位时间内发起请求数量。

## 超卖

最开始会出现500万的标的，交易成功的订单超过500万的情况。

引入队列，将所有写数据库操作放到队列中排队，当库存达到阀值时不再消费队列。